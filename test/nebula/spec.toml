#:schema ../../src/schema.json
[[imports]]
importer = "vault"
arguments.path = "secret/nebula"
arguments.allow_fail = true

[[exports]]
exporter = "vault"
arguments.path = "secret/nebula"

[[generations]]
generator = "nebula-ca"

[generations.arguments]
name = "ca"
public = "nebula-ca-pub"
private = "nebula-ca-priv"

[[generations]]
generator = "nebula-cert"

[generations.arguments]
ca_public = "nebula-ca-pub"
ca_private = "nebula-ca-priv"
name = "cert"
ip = "10.8.0.1/24"
public = "nebula-pub"
private = "nebula-priv"
renew = true

[[generations]]
generator = "age-key"

[generations.arguments]
public = "age.txt.pub"
private = "age.txt"

[[generations]]
generator = "sops"

[generations.arguments]
age = "age.txt.pub"
public = "sops.yaml.pub"
private = "sops.yaml"

[generations.arguments.secrets]
nebula-ca-pub = "nebula-ca-pub"
nebula-ca-priv = "nebula-ca-priv"
nebula-pub = "nebula-pub"
nebula-priv = "nebula-priv"
